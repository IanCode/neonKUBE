# Release: 18.9.4-alpha

## Components

* **neon-cli:** `18.9.4-alpha`
* **neon lib:** `18.9.4-alpha`

## Overview

This is considered a **non-breaking** release that:

* Fixes some bugs (see below)
* Rebases Elasticsearch on OpenJDK 9/10 so that CGROUP memory limits will be honored
* RabbitMQ related enhancements:
  * Adds the `Neon.Xunit.RabbitMQ` library providing a test fixture
  * Adds the `NeonBus` API (a somewhat more advanced API built on EasyMQ)

Note that although there are some breaking library changes described below, we don't expect any users to be impacted.

## Upgrade

1. Run this command for all hives: `neon hive update`

## Library Changes

### Neon.Hive

**BREAKING: `DnsHostsManager` class renamed to `DnsManager` and `HiveProxy.DnsHosts` property renamed to just `Dns` in keeping with the "hive DNS" terminology change.  This is unlikely to impact anyone.

**Neon.Hive:** Added the `LoadBalancerRule.Normalize(bool)` method to fix change detection in unit tests.

### Neon.Xunit

**BREAKING: Neon.Xunit.Hive:** Renamed `includeCore` parameter to `includeSystem` to test fixtures for consistency.  This is unlikely to impact anyone.

**Neon.Xunit:** `ContainerFixture.RunContainer()` now pulls the container image first.
**Neon.Xunit:** `DockerFixture.Reset()` ensures that all stacks are removed before resetting swarm mode to prevent orphaned networks.

### Neon.Xunit.Couchbase

**BREAKING: Neon.Xunit.Couchbase:** Renamed `CouchbaseFixture.Flush()` to `Clear()`.  This is unlikely to impact anyone.

### Neon.Xunit.RabbitMQ

**Neon.Xunit.RabbitMQ:** Published this new library to enable fast RabbitMQ based unit tests.  `RabbitMQFixture` is the new test fixture.
**Neon.Xunit.RabbitMQ:** [#361 Basic RabbitMQ client API](https://github.com/jefflill/NeonForge/issues/361)

## Hive Changes

* [#340 [neon_docker_login] Ansible module setting wrong [.docker/config.conf] file permissions](https://github.com/jefflill/NeonForge/issues/340)
* [#342 [log-collector]: Strip port from [proxy.http_host] log fields](https://github.com/jefflill/NeonForge/issues/342)
* [#352 Upgrade Elasticsearch images to OpenJDK 10](https://github.com/jefflill/NeonForge/issues/352)
* [#357 OpenJDK: Use the the official images and delete [nhive/openjdk]](https://github.com/jefflill/NeonForge/issues/357)
* [#360 Implement RabbitMQ test container and unit test fixture](https://github.com/jefflill/NeonForge/issues/360)
